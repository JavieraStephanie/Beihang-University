package elevator;

import java.util.Scanner;

import elevator.Query.Direction;

public class Request {
	
	private int req_floor;
	private double req_time;
	private Direction direction;
	private int target_floor;
	
	public Request(int floor, Direction dir, double time) {
		this.req_floor = floor;
		this.direction = dir;
		this.req_time = time;
	}
	
	public Request(String req) {
		String[] str = buf.split("[(,)]");
		if("ER".equals(str[1]) != "NONE".equals(str[3])) {
			// only when str[1] is "ER", str[3] is "NONE"
			throw new Exception("Invalid Character Or Format.");
		}
		try {
			target = Integer.parseInt(str[2]);
		} catch(NumberFormatException except) {
			throw new Exception("Floor Number Out Of Range.");
		}
		if(str[3].equals("UP")){
			direction = Direction.UP;
			}
		else if(str[3].equals("DOWN")){
			direction = Direction.DOWN;
			}
		else if(str[3].equals("NONE")){
			direction = Direction.NONE;
			}
		else{
			throw new Exception("Invalid Character Or Format.");
		}
		try {
			time = Long.parseLong(str[4]);
		} catch(NumberFormatException except) {
			throw new Exception("Time Number Out Of Range.");
		}
		if(Query.checkTime(time) == false) {
			throw new Exception("Time Out Of Range.");
		}
		targetFloor = target;
		queryTime = time;
		queryDirection = direction;
	}
	
	public static void main(String[] args) throws Exception {
		String input;
		Scanner scanner = new Scanner(System.in);
		
		while(scanner.hasNextLine()) {
			//Scan the input strings
			input = scanner.nextLine();

			//If the input string equals to "RUN" means that the input event is done
			if(input.equals("RUN")) {
				break;
			}
			
			//INPUT VALIDATION
			//Replace all occurrences of " " and "\t" to nothing
			input = input.replace(" ", "").replace("\t", "");
			char []val = input.toCharArray();
			int content = 0; //to check which content is being validated
			String req = ""; //string to parse
			for(int i = 0; i<val.length; i++) {
				if(val[i] == '(' && content == 0) {
					content++;
					req += val[i];
					continue;
				}
				else if((val[i] == 'F' || val[i] == 'E') && val[i+1] == 'R' && val[i+2] == ',' && content == 1) {
					content++;
					req += val[i];
					req += val[i+1];
					req += val[i+2];
					i+=2;
					continue;
				}
				else if(val[i] >= '0' && val[i] <= '9' && content == 2) {
					content++;
					req += val[i];
					req += val[i+1];
					if(val[i+2] == ',') {
						req += val[i+2];
						i+=2;
					}
					else 
						i++;
					continue;
				}
				else if((val[i] == 'U' && val[i+1] == 'P' && val[i+2] == ',') && content == 3) {
					content++;
					req += "UP,";
					i+=2;
					continue;
				}
				else if ((val[i] == 'D' && val[i+1] == 'O' && val[i+2] == 'W' && val[i+3] == 'N') && content == 3) {
					content++;
					req += "DOWN,";
					i+=4;
					continue;
				}
				else if (val[i] >= '0' && val[i] <= '9' && content == 3) {
					content++;
					req += "NONE,";
					while(val[i]!=')' && i<val.length) {
						req += val[i];
						i++;
					}
					req += ')';
				}
				else if (val[i] >= '0' && val[i] <= '9' && content == 4) {
					while(val[i]!=')' && i<val.length) {
						req += val[i];
						i++;
					}
					req += ')';
				}
				else
					throw new Exception ("Invalid format!");
			}
			
			req = req.replace("(", "").replace(")", "");
			
			String temp[] = req.split(",");
			
			this.req_floor = temp[1];
			
		}
		
		System.out.println("INPUT DONE");
		
		scanner.close();
	}

}
